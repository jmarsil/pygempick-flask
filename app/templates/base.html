{% extends 'bootstrap/base.html' %}

{% block title %}
    {% if title %}{{ title }} - PyGemPick{% else %}Welcome to PyGemPick!{% endif %}
{% endblock %}

{% block head %}
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  
  {{ super() }}
  <style type="text/css">
    
    :root {
    --blue: #007bff;
    --indigo: #6610f2;
    --purple: #6f42c1;
    --pink: #e83e8c;
    --red: #dc3545;
    --orange: #fd7e14;
    --yellow: #ffc107;
    --green: #28a745;
    --teal: #20c997;
    --cyan: #17a2b8;
    --white: #fff;
    --gray: #6c757d;
    --gray-dark: #343a40;
    --primary: #007bff;
    --secondary: #6c757d;
    --success: #28a745;
    --info: #17a2b8;
    --warning: #ffc107;
    --danger: #dc3545;
    --light: #f8f9fa;
    --dark: #343a40;
    --breakpoint-xs: 0;
    --breakpoint-sm: 576px;
    --breakpoint-md: 768px;
    --breakpoint-lg: 992px;
    --breakpoint-xl: 1200px;
    --font-family-sans-serif: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";
    --font-family-monospace: SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;
    }
    
    .btn-rounded {
    -webkit-border-radius: 10em;
    border-radius: 10em;
    }

    .btn-outline-white {
    border: 2px solid #fff!important;
    background-color: transparent!important;
    color: #fff!important;
    }
    
    .navbar-default {
        background-color: #2c3e50;
        border-color: transparent;
        border: 0;
        border-radius: 0;
        padding:10px 0;
        -webkit-box-shadow: 0 1px 10px 0 rgba(0,0,0,0.15);
        -moz-box-shadow: 0 1px 10px 0 rgba(0,0,0,0.15);
        box-shadow: 0 1px 10px 0 rgba(0,0,0,0.15);
    }
    
    .navbar-default .navbar-brand {
        color: #ecf0f1;
        font-weight: 700;
    }
    
    .navbar-default .navbar-brand:hover, .navbar-default .navbar-brand:focus {
        color: #95a5a6;
        background-color: transparent;
    }
    
    .navbar-default .navbar-nav>.active>a, .navbar-default .navbar-nav>.active>a:focus, .navbar-default .navbar-nav>.active>a:hover {
        color: #95a5a6;
        background-color: transparent;
    }
    
    .navbar-default .navbar-nav>.open>a, .navbar-default .navbar-nav>.open>a:hover, .navbar-default .navbar-nav>.open>a:focus {
        color: #ecf0f1;
        background-color: transparent;
    }
    
    .navbar-default .navbar-nav>li>a {
        color: #ecf0f1;
    }
    
    .navbar-default .navbar-nav>li>a:hover, .navbar-default .navbar-nav>li>a:focus {
        color: #95a5a6;
        background-color: transparent;
    }
    
    .dropdown-menu {
        border:0;
        border-radius: 0;
    }
    
    .dropdown-menu>li>a {
        padding: 5px 20px;
    }
    
    .dropdown-menu>li>a:hover, .dropdown-menu>li>a:focus {
        color: #ecf0f1;
        text-decoration: none;
        background-color: #2c3e50;
    }
    
    .navbar-default .navbar-toggle {
        border-color: transparent;
    }
    
    .navbar-default .navbar-toggle:hover, .navbar-default .navbar-toggle:focus {
        background-color:transparent;
    }
    
    .navbar-default .navbar-toggle .icon-bar {
        background-color: #ecf0f1;
    }
    
    .navbar-default .navbar-collapse, .navbar-default .navbar-form {
        border-color: transparent;
    }
    
    .non-auth-back {
      height: 100%;
      width: 100%;
      margin: 0;
      padding: 0;
      color: black;
      text-align: left;
    }
    
    .centered {
     float: none;
     margin-left: auto;
     margin-right: auto;
    }
    html, body {
    height: 100%;
    }
    
    body {
    min-height: 100vh;
    background-size: cover;
    background-repeat: no-repeat;
    background-position: top center;
    }
    
    .col-md-2 .btn-success {
    font-weight: 700;
    }
    
    .col-md-2 ol li{
    text-align: left;
    }
    
    .col-md-2 p {
    margin-top: 10px !important;
    }
    
    .col-md-2 h2 {
    margin-bottom: 30px;
    }
    
    #results-list {
    list-style-type: none;
    }
    
    .pygempick-headers {
    
    background-image: url('/static/picked/sky-828648_1920.jpg');
    background-size: cover;
    background-repeat: no-repeat;
    background-position: top center;
    color: #fff !important;
    padding: 5%;
    
    }
    
   .home-btn {
   
   padding-top: 30px;
   
   }
   
   .navbar-default .navbar-nav>li>.btn-success {
   border-radius: 25px;
   font-weight: 700;
   
   }
   
   .footer .list-unstyled > .list-inline-item > a{
   color: #f5f5f5 !important;
   background-color: transparent;
   }
   
   .navbar-default .navbar-nav>li>.btn-success:hover, .navbar-default .navbar-nav>li>.btn-success:focus {
        color: green !important;
        background-color: #fff !important;
        font-weight: 700;
        border-radius: 25px;
    }
    
    .font-small {
    font-size: .9rem;
    }

    .unique-color-dark {
    background-color: #1c2331!important;
    }
    
    .text-center {
    text-align: center!important;
    }
    .pb-2, .py-2 {
        padding-bottom: .5rem!important;
    }
    .pt-2, .py-2 {
        padding-top: .5rem!important;
    }
    .list-inline {
        padding-left: 0;
        list-style: none;
    }
    .list-unstyled {
        padding-left: 0;
        list-style: none;
    }
    
    .footer {
    position:fixed;
    height: 100px;
    width: 100% !important;
    clear:both;
    padding-top:20px;
    color: #f5f5f5 !important;
    bottom:0;
    }
    
    .wrapper {
    min-height: 100%;
    height: 100%;
    margin: 0 auto -100px; /* the bottom margin is the negative value of the footer's height */
    }
    
    .push {
        height: 100px; /* .push must be the same height as .footer */
    }
    
    .user-post {
    font-size: 1.2em;
    margin-bottom: 10px;
    color: #22334c !important;
    }
    
    .user-img {
    
    border: 2px solid #475e6d !important;
    
    }
    
    .hidden {
    display: none;
    }
    .unhidden {
        display: block;
    }
    .user-img {
        width: 200px;
    }
  </style>
{% endblock %}

{% block navbar %}
    <nav class="navbar navbar-default ">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="{{ url_for('main.index') }}">PyGemPick</a>
            </div>
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav">
                    {% if current_user.is_anonymous %}
                    <li><a href="{{ url_for('auth.register') }}">Register</a></li>
                    {% else %}
                    <li><a href="{{ url_for('main.index') }}">Home</a></li>
                    <li><a href="{{ url_for('main.pubmed_search') }}">Search Pubmed</a></li>
                    <li><a href="{{ url_for('main.pygempick')}}"> Process</a></li>
                    <li><a href="{{ url_for('main.download')}}"> Download</a></li>
                    {% endif %}
                </ul>
                <ul class="nav navbar-nav navbar-right">
                    {% if current_user.is_anonymous %}
                    <li><a class="btn-success" href="{{ url_for('auth.login') }}">Login</a></li>
                    {% else %}
                    <li><a href="{{ url_for('main.user', username=current_user.username) }}">Profile</a></li>
                    <li><a href="{{ url_for('auth.logout') }}">Logout</a></li>
                    {% endif %}
                </ul>
            </div>
         </div>    
         </nav>
{% endblock %}

{% block content %}
    <div class="container wrapper">
        {% if current_user.is_authenticated %}
        {% with tasks = current_user.get_tasks_in_progress() %}
        {% if tasks %}
            {% for task in tasks %}
            <div class="alert alert-success" role="alert">
                {{ task.description }}
                <span id="{{ task.id }}-progress">{{ task.get_progress() }}</span>%
            </div>
            {% endfor %}
        {% endif %}
        {% endwith %}
        {% endif %}
        
        {% with messages = get_flashed_messages() %}
        {% if messages %}
            {% for message in messages %}
            <div class="alert alert-info" role="alert">{{ message }}</div>
            {% endfor %}
        {% endif %}
        {% endwith %}
        
        {# application content needs to be provided in the app_content block #}
        {% block app_content %}{% endblock %}
    </div>
    <div class="push"></div>
    
    {% block footer %}
    <div id="footer" class="footer font-small unique-color-dark pt-4">

    <!-- Footer Elements -->
    <div class="container">

      <!-- Call to action -->
      <ul class="list-unstyled list-inline text-center py-2">
      {% if current_user.is_anonymous %}
        <li class="list-inline-item">
          <h5 class="mb-1">Register for free</h5>
        </li>
        <li class="list-inline-item">
          <a href="{{ url_for('auth.register') }}" class="btn btn-outline-white btn-rounded">Sign up!</a>
        </li>
      {% else %}
        <li class="list-inline-item">
          <a href="{{ url_for('main.index') }}"><h5 class="mb-1">Home</h5></a>
        </li>
        <li class="list-inline-item">
          <a href="{{ url_for('main.pubmed_search') }}"><h5 class="mb-1">Search Pubmed</h5></a>
        </li>
        <li class="list-inline-item">
          <a href="{{ url_for('main.pygempick')}}"><h5 class="mb-1"> Process</h5></a>
        </li>
        <li class="list-inline-item">
          <a href="{{ url_for('main.download')}}"><h5 class="mb-1"> Download</h5></a>
        </li>
      {% endif %}
      
      </ul>
      <!-- Call to action -->

    </div>
    <!-- Footer Elements -->

    <!-- Copyright -->
    <div class="footer-copyright text-center py-3">&copy; Copyright 2018 by <a href="http://chakrablab.com" target="_blank">Chakrab Lab</a>.
    </div>
    <!-- Copyright -->
    </div>
    
{% endblock %}

  <!-- Footer -->  
        
{% endblock %}


{% block scripts %}
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    {{ super() }}
    {{ moment.include_moment() }}
    
    <script>
    
        function set_task_progress(task_id, progress) {
            $('#' + task_id + '-progress').text(progress);
        }
        
        $('a').on('click', function(){
           var target = $(this).attr('rel');
           $("#"+target).siblings("div").hide();
           $("#"+target).toggleClass("hidden unhidden")
        });
        
    </script>
    <script>
    
        {% if current_user.is_authenticated %}

        $(function() {
            var since =0;
            setInterval(function() {
                $.ajax('{{ url_for('main.notifications') }}?since=' + since).done(
                    function(notifications){
                        for (var i = 0; i < notifications.length; i++) {
                            switch (notifications[i].name) {
                                case 'unread_message_count':
                                    set_message_count(notifications[i].data);
                                    break;
                                case 'task_progress':
                                    set_task_progress(
                                        notifications[i].data.task_id,
                                        notifications[i].data.progress
                                        notifications[i].data.description);
                                    break;
                            }
                            since = notifications[i].timestamp;
                        }
                    }
                );
            }, 10000);
        });
    
    {% endif %}
    </script>
    
    <script>
    {% if current_user.is_anonymous %}
    
    $(document).ready(function(){
    var header = $('body');
    
    var backgrounds = new Array(
        "url('/static/picked/blur_6.jpg')"
      , "url('/static/picked/blur_7.jpg')"
      , "url('/static/picked/blur_8.jpg')"
      , "url('/static/picked/blur_9.jpg')"
      , "url('/static/picked/blur_10.jpg')"
      , "url('/static/picked/blur_11.jpg')"
    );
    
    var current = 0;
    
    function nextBackground() {
        current++;
        current = current % backgrounds.length;
        header.css('background-image', backgrounds[current]);
    }
    setInterval(nextBackground, 3000);
    
    header.css('background-image', backgrounds[0]);
    };

    {% endif %}
    </script>
    
{% endblock %}
